import os.path
import configparser
import psycopg
import psycopg.rows


def connect(db, **kwargs):
    inifile = os.getenv('DATABASEINI', os.path.expanduser("~/.database.ini"))
    config = configparser.ConfigParser()
    config.read(inifile)
    p = config[db]
    if 'dbname' not in p:
        p['dbname'] = db
    return psycopg.connect(
        f"dbname={p['dbname']} host={p['host']} user={
            p['user']} password={p['password']}",
        row_factory=psycopg.rows.namedtuple_row)


def disconnect_all():   # only needed for perl
    pass
